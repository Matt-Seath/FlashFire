{% extends "base.html" %}

{% block header %}
    <h1>{% block title %}
        {% if rows %}
            {{ rows[0][1] }}
        {% else %}
            Quote
        {% endif %}    
    {% endblock %}</h1>
{% endblock %}


{% block content %}
    {% if rows %}
    
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h3><a href="platform.quote">Quote</a> ❯❯ &nbsp; {{ rows[0][2] }}  ({{ rows[0][1] }})</h3>
            <div class="btn-toolbar mb-2 mb-md-0">
                <div class="btn-group mr-2">
                    <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
                </div>
                <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
                    <span data-feather="calendar"></span>
                    This week
                </button>
            </div>
        </div>

        <!-- TradingView Widget BEGIN -->
        <div class="tradingview-widget-container">
        <div id="tradingview_551d7"></div>
        <div class="tradingview-widget-copyright"><a href="https://www.tradingview.com/symbols/NASDAQ-AAPL/"
            rel="noopener" target="_blank"><span class="blue-text">AAPL Chart</span></a> by TradingView</div>
        <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
        <script type="text/javascript">
        new TradingView.widget(
        {
        "width": "100%",
        "height": 610,
        "symbol": "{{ rows[0][3] }}:{{ rows[0][1] }}",
        "interval": "D",
        "timezone": "America/New_York",
        "theme": "light",
        "style": "1",
        "locale": "en",
        "toolbar_bg": "#f1f3f6",
        "enable_publishing": false,
        "allow_symbol_change": true,
        "container_id": "tradingview_551d7"
        }
        );
        </script>
        </div>
        <!-- TradingView Widget END -->

        <div class="container-fluid">
            <div class="table-responsive">
                <table class='table table-striped table-sm'>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Open</th>
                            <th>Close</ht>
                            <th>High</th>
                            <th>Low</th>
                            <th>Volume</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in rows %}
                            <tr>
                                <td>{{ row.date }}</td>
                                <td>{{ row.open }}</td>
                                <td>{{ row.close }}</td>
                                <td>{{ row.high }}</td>
                                <td>{{ row.low }}</td>                         
                                <td>{{ row.volume }}</td>                         
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>   

    {% else %}

        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h3>Quote</h3>
            <div class="btn-toolbar mb-2 mb-md-0">
                <div class="btn-group mr-2">
                    <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
                    <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
                </div>
                <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
                    <span data-feather="calendar"></span>
                    This week
                </button>
            </div>
        </div>

    {% endif %}
{% endblock %}